<svg width="1000" height="700" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#888"/>
    </marker>
  </defs>

  <!-- Title -->
  <text x="500" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#CBD5E0">Database Entity Details</text>

  <!-- Organizations Table -->
  <g id="organizations">
    <rect x="50" y="60" width="400" height="150" fill="none" stroke="#4299E1" stroke-width="2" rx="5"/>
    <rect x="50" y="60" width="400" height="30" fill="none" stroke="#4299E1" stroke-width="2" rx="5 5 0 0"/>
    <text x="250" y="80" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#63B3ED">organizations</text>

    <g font-family="monospace" font-size="12" fill="#A0AEC0">
      <text x="60" y="110">id: UUID (PK)</text>
      <text x="60" y="130">name: VARCHAR(255)</text>
      <text x="60" y="150">created_at: TIMESTAMPTZ</text>
      <text x="60" y="170">updated_at: TIMESTAMPTZ</text>
    </g>
  </g>

  <!-- Bots Table -->
  <g id="bots">
    <rect x="550" y="60" width="400" height="190" fill="none" stroke="#48BB78" stroke-width="2" rx="5"/>
    <rect x="550" y="60" width="400" height="30" fill="none" stroke="#48BB78" stroke-width="2" rx="5 5 0 0"/>
    <text x="750" y="80" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#68D391">bots</text>

    <g font-family="monospace" font-size="12" fill="#A0AEC0">
      <text x="560" y="110">id: UUID (PK)</text>
      <text x="560" y="130">organization_id: UUID (FK)</text>
      <text x="560" y="150">name: VARCHAR(255)</text>
      <text x="560" y="170">configuration: JSONB</text>
      <text x="560" y="190">created_at: TIMESTAMPTZ</text>
      <text x="560" y="210">updated_at: TIMESTAMPTZ</text>
    </g>
  </g>

  <!-- Bot Memories Table -->
  <g id="bot_memories">
    <rect x="50" y="290" width="280" height="130" fill="none" stroke="#B794F4" stroke-width="2" rx="5"/>
    <rect x="50" y="290" width="280" height="30" fill="none" stroke="#B794F4" stroke-width="2" rx="5 5 0 0"/>
    <text x="190" y="310" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#D6BCFA">bot_memories</text>

    <g font-family="monospace" font-size="12" fill="#A0AEC0">
      <text x="60" y="340">id: UUID (PK)</text>
      <text x="60" y="360">bot_id: UUID (FK)</text>
      <text x="60" y="380">key: TEXT</text>
      <text x="60" y="400">value: TEXT</text>
    </g>
  </g>

  <!-- User Sessions Table -->
  <g id="user_sessions">
    <rect x="360" y="290" width="280" height="170" fill="none" stroke="#FBBF24" stroke-width="2" rx="5"/>
    <rect x="360" y="290" width="280" height="30" fill="none" stroke="#FBBF24" stroke-width="2" rx="5 5 0 0"/>
    <text x="500" y="310" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#FCD34D">user_sessions</text>

    <g font-family="monospace" font-size="12" fill="#A0AEC0">
      <text x="370" y="340">id: UUID (PK)</text>
      <text x="370" y="360">user_id: UUID (FK)</text>
      <text x="370" y="380">bot_id: UUID (FK)</text>
      <text x="370" y="400">session_token: TEXT</text>
      <text x="370" y="420">created_at: TIMESTAMPTZ</text>
      <text x="370" y="440">expires_at: TIMESTAMPTZ</text>
    </g>
  </g>

  <!-- KB Collections Table -->
  <g id="kb_collections">
    <rect x="670" y="290" width="280" height="150" fill="none" stroke="#4FD1C5" stroke-width="2" rx="5"/>
    <rect x="670" y="290" width="280" height="30" fill="none" stroke="#4FD1C5" stroke-width="2" rx="5 5 0 0"/>
    <text x="810" y="310" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#81E6D9">kb_collections</text>

    <g font-family="monospace" font-size="12" fill="#A0AEC0">
      <text x="680" y="340">id: TEXT (PK)</text>
      <text x="680" y="360">bot_id: UUID (FK)</text>
      <text x="680" y="380">name: TEXT</text>
      <text x="680" y="400">description: TEXT</text>
      <text x="680" y="420">created_at: TIMESTAMPTZ</text>
    </g>
  </g>

  <!-- Users Table -->
  <g id="users">
    <rect x="50" y="480" width="280" height="170" fill="none" stroke="#FC8181" stroke-width="2" rx="5"/>
    <rect x="50" y="480" width="280" height="30" fill="none" stroke="#FC8181" stroke-width="2" rx="5 5 0 0"/>
    <text x="190" y="500" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#FC8181">users</text>

    <g font-family="monospace" font-size="12" fill="#A0AEC0">
      <text x="60" y="530">id: UUID (PK)</text>
      <text x="60" y="550">username: TEXT</text>
      <text x="60" y="570">email: TEXT</text>
      <text x="60" y="590">password_hash: TEXT</text>
      <text x="60" y="610">active: BOOLEAN</text>
      <text x="60" y="630">created_at: TIMESTAMPTZ</text>
    </g>
  </g>

  <!-- Message History Table -->
  <g id="message_history">
    <rect x="360" y="480" width="280" height="170" fill="none" stroke="#A78BFA" stroke-width="2" rx="5"/>
    <rect x="360" y="480" width="280" height="30" fill="none" stroke="#A78BFA" stroke-width="2" rx="5 5 0 0"/>
    <text x="500" y="500" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#C4B5FD">message_history</text>

    <g font-family="monospace" font-size="12" fill="#A0AEC0">
      <text x="370" y="530">id: UUID (PK)</text>
      <text x="370" y="550">session_id: UUID (FK)</text>
      <text x="370" y="570">user_id: UUID (FK)</text>
      <text x="370" y="590">bot_id: UUID (FK)</text>
      <text x="370" y="610">message: TEXT</text>
      <text x="370" y="630">sender: TEXT</text>
    </g>
  </g>

  <!-- KB Documents Table -->
  <g id="kb_documents">
    <rect x="670" y="480" width="280" height="170" fill="none" stroke="#34D399" stroke-width="2" rx="5"/>
    <rect x="670" y="480" width="280" height="30" fill="none" stroke="#34D399" stroke-width="2" rx="5 5 0 0"/>
    <text x="810" y="500" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#6EE7B7">kb_documents</text>

    <g font-family="monospace" font-size="12" fill="#A0AEC0">
      <text x="680" y="530">id: UUID (PK)</text>
      <text x="680" y="550">collection_id: TEXT (FK)</text>
      <text x="680" y="570">content: TEXT</text>
      <text x="680" y="590">embeddings: VECTOR</text>
      <text x="680" y="610">metadata: JSONB</text>
      <text x="680" y="630">created_at: TIMESTAMPTZ</text>
    </g>
  </g>

  <!-- Relationships -->
  <g stroke="#888" stroke-width="2" fill="none">
    <!-- organizations to bots -->
    <line x1="450" y1="135" x2="550" y2="135" marker-end="url(#arrow)"/>
    <text x="500" y="130" font-family="Arial, sans-serif" font-size="10" fill="#718096">1:N</text>

    <!-- bots to bot_memories -->
    <line x1="750" y1="250" x2="190" y2="290" marker-end="url(#arrow)"/>
    <text x="470" y="270" font-family="Arial, sans-serif" font-size="10" fill="#718096">1:N</text>

    <!-- bots to user_sessions -->
    <line x1="750" y1="250" x2="500" y2="290" marker-end="url(#arrow)"/>

    <!-- bots to kb_collections -->
    <line x1="750" y1="250" x2="810" y2="290" marker-end="url(#arrow)"/>
    <text x="780" y="270" font-family="Arial, sans-serif" font-size="10" fill="#718096">1:N</text>

    <!-- kb_collections to kb_documents -->
    <line x1="810" y1="440" x2="810" y2="480" marker-end="url(#arrow)"/>
    <text x="825" y="460" font-family="Arial, sans-serif" font-size="10" fill="#718096">1:N</text>

    <!-- user_sessions to message_history -->
    <line x1="500" y1="460" x2="500" y2="480" marker-end="url(#arrow)"/>
    <text x="515" y="470" font-family="Arial, sans-serif" font-size="10" fill="#718096">1:N</text>

    <!-- users to user_sessions (dotted) -->
    <path d="M 330 565 L 360 390" stroke-dasharray="5,5" marker-end="url(#arrow)" opacity="0.6"/>
    <text x="345" y="475" font-family="Arial, sans-serif" font-size="10" fill="#718096">1:N</text>
  </g>

  <!-- Legend -->
  <g id="legend" transform="translate(50, 670)">
    <text x="0" y="0" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#CBD5E0">Color Coding:</text>

    <rect x="100" y="-10" width="20" height="10" fill="none" stroke="#4299E1" stroke-width="2"/>
    <text x="125" y="0" font-family="Arial, sans-serif" font-size="11" fill="#A0AEC0">Organization</text>

    <rect x="220" y="-10" width="20" height="10" fill="none" stroke="#48BB78" stroke-width="2"/>
    <text x="245" y="0" font-family="Arial, sans-serif" font-size="11" fill="#A0AEC0">Bot Core</text>

    <rect x="320" y="-10" width="20" height="10" fill="none" stroke="#FBBF24" stroke-width="2"/>
    <text x="345" y="0" font-family="Arial, sans-serif" font-size="11" fill="#A0AEC0">Sessions</text>

    <rect x="420" y="-10" width="20" height="10" fill="none" stroke="#4FD1C5" stroke-width="2"/>
    <text x="445" y="0" font-family="Arial, sans-serif" font-size="11" fill="#A0AEC0">Knowledge</text>

    <rect x="530" y="-10" width="20" height="10" fill="none" stroke="#FC8181" stroke-width="2"/>
    <text x="555" y="0" font-family="Arial, sans-serif" font-size="11" fill="#A0AEC0">Users</text>

    <rect x="620" y="-10" width="20" height="10" fill="none" stroke="#A78BFA" stroke-width="2"/>
    <text x="645" y="0" font-family="Arial, sans-serif" font-size="11" fill="#A0AEC0">Messages</text>
  </g>
</svg>

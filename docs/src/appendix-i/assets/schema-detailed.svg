<svg width="800" height="450" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#666"/>
    </marker>
  </defs>

  <!-- Title -->
  <text x="400" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="600" fill="#333">Database Entity Details</text>

  <!-- Organizations -->
  <rect x="20" y="60" width="120" height="40" fill="none" stroke="#4A90E2" stroke-width="2" rx="5"/>
  <text x="80" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#333">organizations</text>

  <!-- Bots -->
  <rect x="200" y="60" width="100" height="40" fill="none" stroke="#7ED321" stroke-width="2" rx="5"/>
  <text x="250" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#333">bots</text>

  <!-- Users -->
  <rect x="360" y="60" width="100" height="40" fill="none" stroke="#F5A623" stroke-width="2" rx="5"/>
  <text x="410" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#333">users</text>

  <!-- User Sessions -->
  <rect x="520" y="60" width="120" height="40" fill="none" stroke="#BD10E0" stroke-width="2" rx="5"/>
  <text x="580" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#333">user_sessions</text>

  <!-- Bot Memories -->
  <rect x="20" y="160" width="120" height="40" fill="none" stroke="#50E3C2" stroke-width="2" rx="5"/>
  <text x="80" y="185" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#333">bot_memories</text>

  <!-- Message History -->
  <rect x="200" y="160" width="120" height="40" fill="none" stroke="#4A90E2" stroke-width="2" rx="5"/>
  <text x="260" y="185" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#333">message_history</text>

  <!-- KB Collections -->
  <rect x="380" y="160" width="120" height="40" fill="none" stroke="#7ED321" stroke-width="2" rx="5"/>
  <text x="440" y="185" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#333">kb_collections</text>

  <!-- KB Documents -->
  <rect x="560" y="160" width="120" height="40" fill="none" stroke="#F5A623" stroke-width="2" rx="5"/>
  <text x="620" y="185" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#333">kb_documents</text>

  <!-- Field Details -->
  <g font-family="Arial, sans-serif" font-size="11" fill="#666">
    <!-- organizations -->
    <text x="30" y="115">id, name</text>
    <text x="30" y="130">created_at</text>

    <!-- bots -->
    <text x="210" y="115">id, org_id</text>
    <text x="210" y="130">name, config</text>

    <!-- users -->
    <text x="370" y="115">id, username</text>
    <text x="370" y="130">email, active</text>

    <!-- user_sessions -->
    <text x="530" y="115">id, user_id, bot_id</text>
    <text x="530" y="130">token, expires_at</text>

    <!-- bot_memories -->
    <text x="30" y="215">id, bot_id</text>
    <text x="30" y="230">key, value</text>

    <!-- message_history -->
    <text x="210" y="215">id, session_id</text>
    <text x="210" y="230">message, sender</text>

    <!-- kb_collections -->
    <text x="390" y="215">id, bot_id</text>
    <text x="390" y="230">name, description</text>

    <!-- kb_documents -->
    <text x="570" y="215">id, collection_id</text>
    <text x="570" y="230">content, embeddings</text>
  </g>

  <!-- Relationships -->
  <g stroke="#666" stroke-width="2" fill="none">
    <!-- organizations to bots -->
    <line x1="140" y1="80" x2="200" y2="80" marker-end="url(#arrow)"/>

    <!-- users to user_sessions -->
    <line x1="460" y1="80" x2="520" y2="80" marker-end="url(#arrow)"/>

    <!-- bots to user_sessions -->
    <path d="M250,100 Q250,120 580,120 Q580,100 580,100" stroke-dasharray="3,3" marker-end="url(#arrow)" opacity="0.6"/>

    <!-- bots to bot_memories -->
    <path d="M250,100 Q250,130 80,130 Q80,150 80,160" marker-end="url(#arrow)" opacity="0.6"/>

    <!-- user_sessions to message_history -->
    <path d="M580,100 Q580,130 260,130 Q260,150 260,160" marker-end="url(#arrow)" opacity="0.6"/>

    <!-- bots to kb_collections -->
    <path d="M250,100 Q250,130 440,130 Q440,150 440,160" marker-end="url(#arrow)" opacity="0.6"/>

    <!-- kb_collections to kb_documents -->
    <line x1="500" y1="180" x2="560" y2="180" marker-end="url(#arrow)"/>
  </g>

  <!-- Relationship labels -->
  <text x="170" y="75" font-family="Arial, sans-serif" font-size="11" fill="#666">1:N</text>
  <text x="490" y="75" font-family="Arial, sans-serif" font-size="11" fill="#666">1:N</text>
  <text x="530" y="175" font-family="Arial, sans-serif" font-size="11" fill="#666">1:N</text>
  <text x="165" y="145" font-family="Arial, sans-serif" font-size="11" fill="#666">1:N</text>
  <text x="350" y="145" font-family="Arial, sans-serif" font-size="11" fill="#666">1:N</text>
  <text x="420" y="145" font-family="Arial, sans-serif" font-size="11" fill="#666">1:N</text>

  <!-- Schema Info Box -->
  <g transform="translate(20, 260)">
    <rect width="760" height="140" fill="none" stroke="#666" stroke-width="1" rx="5" opacity="0.3"/>
    <text x="10" y="20" font-family="Arial, sans-serif" font-size="12" font-weight="600" fill="#333">Key Relationships:</text>

    <text x="10" y="40" font-family="Arial, sans-serif" font-size="12" fill="#666">• Organizations own multiple Bots</text>
    <text x="10" y="55" font-family="Arial, sans-serif" font-size="12" fill="#666">• Users create multiple Sessions with Bots</text>
    <text x="10" y="70" font-family="Arial, sans-serif" font-size="12" fill="#666">• Sessions generate Message History</text>
    <text x="10" y="85" font-family="Arial, sans-serif" font-size="12" fill="#666">• Bots maintain Memories (key-value pairs)</text>
    <text x="10" y="100" font-family="Arial, sans-serif" font-size="12" fill="#666">• Bots have Knowledge Collections containing Documents</text>
    <text x="10" y="115" font-family="Arial, sans-serif" font-size="12" fill="#666">• Documents store embeddings for vector search</text>
    <text x="10" y="130" font-family="Arial, sans-serif" font-size="12" fill="#666">• All entities use UUIDs as primary keys (except KB collections using TEXT)</text>
  </g>

  <!-- Description -->
  <text x="400" y="430" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#666">
    Core database schema supporting multi-tenant bot operations with session management and vector search capabilities
  </text>
</svg>

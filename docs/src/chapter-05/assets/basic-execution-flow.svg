<svg width="700" height="600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#888"/>
    </marker>
  </defs>

  <!-- Title -->
  <text x="350" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#CBD5E0">BASIC Script Execution Flow</text>

  <!-- start.bas (Raw Text) -->
  <rect x="250" y="60" width="200" height="60" fill="none" stroke="#63B3ED" stroke-width="2" rx="8"/>
  <text x="350" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#90CDF4">start.bas</text>
  <text x="350" y="105" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#CBD5E0">(Raw Text)</text>

  <!-- Arrow down -->
  <line x1="350" y1="120" x2="350" y2="150" stroke="#888" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Tokenizer -->
  <rect x="200" y="150" width="300" height="80" fill="none" stroke="#F6AD55" stroke-width="2" rx="8"/>
  <text x="350" y="175" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#FBD38D">Tokenizer (Rhai)</text>
  <text x="350" y="195" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#FED7AA">• Split into tokens</text>
  <text x="350" y="210" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#FED7AA">• Identify keywords</text>

  <!-- Arrow down -->
  <line x1="350" y1="230" x2="350" y2="260" stroke="#888" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Parser -->
  <rect x="200" y="260" width="300" height="80" fill="none" stroke="#B794F4" stroke-width="2" rx="8"/>
  <text x="350" y="285" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#D6BCFA">Parser (AST)</text>
  <text x="350" y="305" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#E9D8FD">• Build syntax tree</text>
  <text x="350" y="320" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#E9D8FD">• Validate structure</text>

  <!-- Arrow down -->
  <line x1="350" y1="340" x2="350" y2="370" stroke="#888" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Keyword Mapping -->
  <rect x="200" y="370" width="300" height="80" fill="none" stroke="#48BB78" stroke-width="2" rx="8"/>
  <text x="350" y="395" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#68D391">Keyword Mapping</text>
  <text x="350" y="415" text-anchor="middle" font-family="monospace" font-size="10" fill="#9AE6B4">TALK → talk_handler</text>
  <text x="350" y="430" text-anchor="middle" font-family="monospace" font-size="10" fill="#9AE6B4">HEAR → hear_handler</text>

  <!-- Arrow down -->
  <line x1="350" y1="450" x2="350" y2="480" stroke="#888" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Runtime Execution -->
  <rect x="100" y="480" width="500" height="150" fill="none" stroke="#4A5568" stroke-width="2" rx="10" stroke-dasharray="5,5" opacity="0.6"/>
  <text x="350" y="505" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#A0AEC0">Runtime Execution</text>

  <!-- Execution boxes inside -->
  <g id="execution-flow">
    <!-- Line 1: TALK -->
    <rect x="140" y="530" width="100" height="40" fill="none" stroke="#63B3ED" stroke-width="1" rx="5"/>
    <text x="190" y="545" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#90CDF4">Line 1</text>
    <text x="190" y="560" text-anchor="middle" font-family="monospace" font-size="10" fill="#CBD5E0">TALK</text>

    <!-- Arrow -->
    <line x1="240" y1="550" x2="280" y2="550" stroke="#888" stroke-width="1" marker-end="url(#arrow)"/>

    <!-- Line 2: HEAR -->
    <rect x="280" y="530" width="100" height="40" fill="none" stroke="#F6AD55" stroke-width="1" rx="5"/>
    <text x="330" y="545" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#FBD38D">Line 2</text>
    <text x="330" y="560" text-anchor="middle" font-family="monospace" font-size="10" fill="#CBD5E0">HEAR</text>

    <!-- Arrow down -->
    <line x1="330" y1="570" x2="330" y2="580" stroke="#888" stroke-width="1" marker-end="url(#arrow)"/>

    <!-- Line 3: IF/THEN -->
    <rect x="280" y="580" width="100" height="40" fill="none" stroke="#B794F4" stroke-width="1" rx="5"/>
    <text x="330" y="595" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#D6BCFA">Line 3</text>
    <text x="330" y="610" text-anchor="middle" font-family="monospace" font-size="10" fill="#CBD5E0">IF/THEN</text>

    <!-- Arrow -->
    <line x1="380" y1="600" x2="420" y2="600" stroke="#888" stroke-width="1" marker-end="url(#arrow)"/>

    <!-- Line 4: Action -->
    <rect x="420" y="580" width="100" height="40" fill="none" stroke="#48BB78" stroke-width="1" rx="5"/>
    <text x="470" y="595" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#68D391">Line 4</text>
    <text x="470" y="610" text-anchor="middle" font-family="monospace" font-size="10" fill="#CBD5E0">Action</text>
  </g>

  <!-- Arrow down from Runtime -->
  <line x1="350" y1="630" x2="350" y2="660" stroke="#888" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- User Response -->
  <rect x="250" y="660" width="200" height="60" fill="none" stroke="#FC8181" stroke-width="2" rx="8"/>
  <text x="350" y="685" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#FC8181">User Response</text>
  <text x="350" y="705" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#FEB2B2">Output/Interaction</text>

  <!-- Process steps on the side -->
  <g id="process-steps" font-family="Arial, sans-serif" font-size="12" fill="#718096">
    <text x="50" y="90" text-anchor="end">1. Source</text>
    <text x="50" y="190" text-anchor="end">2. Tokenize</text>
    <text x="50" y="300" text-anchor="end">3. Parse</text>
    <text x="50" y="410" text-anchor="end">4. Map</text>
    <text x="50" y="550" text-anchor="end">5. Execute</text>
    <text x="50" y="690" text-anchor="end">6. Output</text>
  </g>
</svg>
